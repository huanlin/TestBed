I wrote this article right after I successfully created my first FlubuCore build script. So this article is for beginners, and it won't show you anything advanced.

## Why FlubuCore?

About two years ago, I wrote two articles about using Nuke,  which is an open-source build automation system. Since then, I've used Nuke to build my .NET projects.

When I found FlubuCore, just like I found new flavors of instant noodles at supermarkets, I always want to try them. So here I am.

FlubuCore means Fluent Builder Core. You can tell from the name that it's a build system with fluent API calls, and it supports .NET Core.

While FlubuCore also support "traditional" .NET Framework, I only care about .NET Core. So I will focus on .NET Core in this article. You can find more information about .NET Framework support from FlubuCore document.

OK! Here we go.

## Installation

You can use the following command to install FlubuCore global tool:

```dotnet tool install --global FlubuCore.GlobalTool```

Or, if you want to get new features as soon as possible, you can install a preview version:

```dotnet tool install --global FlubuCore.GlobalTool --version 5.0.0-preview4```

üëâ I was using  v5.0.3 in this article.

After the global tool installed, you can run your build script from command line.

Reminder: when you update FlubuCore packages from your build project, don't forget to update this global tool as well. You can use the following command to update it:

```dotnet tool update --global flubucore.globaltool```

## Adding Build Script Project

One thing I like FlubuCore (and Nuke) is that we can write our build script with C#, just like what we do as usual. So the first step is adding a new project to your .NET solution, and it will be the "build project" for building your .NET solution.

> p.s. FlubuCore provides a project template that can help you create a build script. However, I prefer do it "by hand" at the first time.

While creating your build project, it's suggested that you follow conventions and name it build, Build,  or _Build , and place it under your root of repository or source folder. Following conventions can save you some time and troubles. (There will be a list of common names later.Ôºâ

Now open your solution in Visual Studio,  and add a new project with Class Library (.NET Core) template. Use "build" as the project name, and place it under the root of your repository. The following figure shows a directory layout I preferred:

(FIGURE 1)

Expand folders a little bit, it looks like:

```
(root)
  + build
    build.csproj
    BuildScript.cs
  + source
    - BuildAll.sln
    + MyApp
    + ClassLibrary1
  + doc
  + output 
```

In which "output" folder is for build output, and it will be created during build process. Usually we add "output" to the ignore list of a Git repository.

You can also place your build project under "source" directory. No matter how you structure your project folders, the important thing is to make sure FlubuCore can find your build script and solution file.

After the build project created, you need to add FlubuCore package reference to it.

(FIGURE 2. NuGet window)

üëâ It was v4.3.7 when I started this article, and then updated to v5.0.3. You can check "Include prerelease" if you want some new features.

Now rename Class1.cs (generated by project template) to "BuildScript.cs" and rename class name to "BuildScript" as well.

You can paste the following code sample to your build script file:

[Code Sample](https://gist.github.com/huanlin/e8121225b19f6fd3183703b1acaab192#file-flubucore_buildscript-cs)


This example demonstrates the following tasks:

- setting output directory (see OutputDir property at the line 15 and 44)
- product versioning with external file ProductVersion.txt (Line 26 and 45)

> p.s. You can also use UpdateNetCoreVersionTask method for product versioning. With this approach, FlubuCore will add <Version>„ÄÅ<AssemblyVersion>„ÄÅ<FileVersion> elements to your .csproj files during build process.

In this example, ProductVersion.txt is simply a text file that contains one line of text indicating your product version, for example "1.3.2."

Once your build script is ready, make sure it compiles with no errors, then you can move on to next step and run your build script with flubu command line tool.

## Run Your Build Script

Open console (command line) window, change current directory to the root of your repository, then enter the following command to run your build script:

```flubu compile```

In which "compile" is the target name corresponding to the string passed to CreateTarget method in BuildScript.cs shown earlier (line 40).

The build process looks like:

(FIGURE 3: Build process)

Note there are messages telling you FlubuCore has found your build script file 'build/BuildScript.cs' and will use it. As mentioned earlier, if you follow FlubuCore's conventions for naming and file location, things will be easier.

The official document has a list of default (automatic searched)  file and directory name, shown as below (the item with bold and colorful font is my preference):

- Build.cs
- BuildScript.cs
- DeployScript.cs
- DeploymentScript.cs
- _Build/Build.cs
- _Build/BuildScript.cs
- Build/Build.cs
- **Build/BuildScript.cs**
- _BuildScript/BuildScript.cs
- _BuildScripts/BuildScript.cs
- BuildScript/BuildScript.cs
- buildscript/deployscript.cs
- buildscripts/buildscript.cs
- buildscripts/deployscript.cs
- BuildScript/DeploymentScript.cs
- BuildScripts/DeploymentScript.cs

## Using .flubu File

If FlubuCore couldn't find your build script files due to whatever reasons, you can tell FlubuCore where they are with a simple text file. Specifically, you create a text file named ".flubu" and place it under the root directory of your repository. In that file, you explicitly specify both of your build script file (.cs) and project file (.csproj) with relative path names.

FlubuCore command line tool has an option to help you create .flubu file,  simply type  flubu setup and answer questions, shown as the figure below:

(FIGURE 4: screenshot of flubu setup)

After you answered questions and closed the program, you can find a ".flubu" file created at current directory.  The content of .flubu file looks like:

```build/BuildScript.cs```
```build/build.csproj```

Despite the content of .flubu file is pretty simple, it can make your life a lot easier. Specifically, when FlubuCore starts to run a build script, it searches .flubu file automatically, and it keeps searching it all the way up through parent directories until that file is found or reached the root directory of current drive. The location where a .flubu file is found will be used as the "work directory" during a build process, and a correct "work directory" is crucial  for us to use relative path in our  build scripts. You don't want to move your build scripts to other machines only to see them failed because some files are not found.

> üëâ Bottom line: Use .flubu file and avoid full path (absolute path) in your build scripts.

I hope this article can help you get started with FlubuCore. Enjoy! 

If you like it, don't forget to [give it a "star" on GitHub](https://github.com/dotnetcore/FlubuCore/)

For more information, see [FlubuCore online document](https://flubucore.dotnetcore.xyz/). 
